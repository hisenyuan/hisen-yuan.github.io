<!-- build time:Sat Feb 19 2022 11:51:06 GMT+0800 (China Standard Time) --><!doctype html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css"><meta name="keywords" content="load,Load Averages,linux"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0"><meta name="description" content="零、背景最近做压力测试，不同的系统的机器监控数据差异明显A 系统：CPU 高 load 低B 系统：CPU 低 load 高那么是什么导致 A B 系统出现这种情况？CPU 高了系统肯定跑不动了，那么 load 多高代表系统跑不动呢？一、解释A 系统的原因CPU 很忙，没有等待其它资源，瓶颈在 CPU。B 系统的原因等待磁盘 I/O 完成的进程过多，导致进程队列长度过大，但是 CPU 运行的进程却"><meta name="keywords" content="load,Load Averages,linux"><meta property="og:type" content="article"><meta property="og:title" content="理解 Linux Load Averages"><meta property="og:url" content="http://hisen.me/20201026-Understanding-Linux-Load-Averages/index.html"><meta property="og:site_name" content="HiSEN"><meta property="og:description" content="零、背景最近做压力测试，不同的系统的机器监控数据差异明显A 系统：CPU 高 load 低B 系统：CPU 低 load 高那么是什么导致 A B 系统出现这种情况？CPU 高了系统肯定跑不动了，那么 load 多高代表系统跑不动呢？一、解释A 系统的原因CPU 很忙，没有等待其它资源，瓶颈在 CPU。B 系统的原因等待磁盘 I/O 完成的进程过多，导致进程队列长度过大，但是 CPU 运行的进程却"><meta property="og:locale" content="zh-Hans"><meta property="og:updated_time" content="2020-10-30T02:37:38.951Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="理解 Linux Load Averages"><meta name="twitter:description" content="零、背景最近做压力测试，不同的系统的机器监控数据差异明显A 系统：CPU 高 load 低B 系统：CPU 低 load 高那么是什么导致 A B 系统出现这种情况？CPU 高了系统肯定跑不动了，那么 load 多高代表系统跑不动呢？一、解释A 系统的原因CPU 很忙，没有等待其它资源，瓶颈在 CPU。B 系统的原因等待磁盘 I/O 完成的进程过多，导致进程队列长度过大，但是 CPU 运行的进程却"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",sidebar:{position:"left",display:"post"},fancybox:!0,motion:!0,duoshuo:{userId:"undefined",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:"",labels:""}}</script><link rel="canonical" href="http://hisen.me/20201026-Understanding-Linux-Load-Averages/"><title>理解 Linux Load Averages | HiSEN</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?67bcfe73b301307394c3443503d43472";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div class="container one-collumn sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">HiSEN</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">Personal Technology Blog</h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-categories"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-booklist"><a href="/booklist" rel="section"><i class="menu-item-icon fa fa-fw fa-list-ol"></i><br>书单</a></li><li class="menu-item menu-item-about"><a href="/about" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup"><span class="search-icon fa fa-search"></span> <input type="text" id="local-search-input"><div id="local-search-result"></div><span class="popup-btn-close">close</span></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://hisen.me/20201026-Understanding-Linux-Load-Averages/"><span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="hisenyuan"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.gif"></span><span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="HiSEN"><span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject"><img style="display:none" itemprop="url image" alt="HiSEN" src=""></span></span><header class="post-header"><h2 class="post-title" itemprop="name headline">理解 Linux Load Averages</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-10-26T19:02:56+08:00">2020-10-26 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/linux/" itemprop="url" rel="index"><span itemprop="name">linux</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="零、背景"><a href="#零、背景" class="headerlink" title="零、背景"></a>零、背景</h1><p>最近做压力测试，不同的系统的机器监控数据差异明显<br>A 系统：CPU 高 load 低<br>B 系统：CPU 低 load 高</p><p>那么是什么导致 A B 系统出现这种情况？<br>CPU 高了系统肯定跑不动了，那么 load 多高代表系统跑不动呢？</p><h1 id="一、解释"><a href="#一、解释" class="headerlink" title="一、解释"></a>一、解释</h1><ol><li>A 系统的原因<br>CPU 很忙，没有等待其它资源，瓶颈在 CPU。</li><li>B 系统的原因<br>等待磁盘 I/O 完成的进程过多，导致进程队列长度过大，<br>但是 CPU 运行的进程却很少，这样就导致负载过大，但 CPU 使用率低，瓶颈不在 CPU，可能在 I/O。</li></ol><h1 id="二、load-averages-知识"><a href="#二、load-averages-知识" class="headerlink" title="二、load averages 知识"></a>二、load averages 知识</h1><ol><li>Linux 系统下代表的是 system load averages。</li><li><p>Linux load averages track not just runnable tasks, but also tasks in the uninterruptible sleep state.<br>Linux 平均负载不仅跟踪可运行的任务，还跟踪处于不可中断睡眠状态的任务。</p></li><li><p>On Linux, load averages are (or try to be) “system load averages”, for the system as a whole, measuring the number of threads that are working and waiting to work (CPU, disk, uninterruptible locks). Put differently, it measures the number of threads that aren’t completely idle. Advantage: includes demand for different resources.<br>在 Linux 上，负载平均值是(或试图是)“系统负载平均值” ，对于整个系统来说，测量正在工作和等待工作的线程数(CPU、磁盘、不可中断锁)。换句话说，它测量的是没有完全空闲的线程数量。优势: 包括对不同资源的需求。</p></li><li>In 1993, a Linux engineer found a nonintuitive case with load averages, and with a three-line patch changed them forever from “CPU load averages” to what one might call “system load averages.” His change included tasks in the uninterruptible state, so that load averages reflected demand for disk resources and not just CPUs.<br>1993年，一位 Linux 工程师发现了一个与平均负载不直观的案例，一个三行补丁永远地将它们从“ CPU 负载平均值”改变为人们可能称之为“系统负载平均值”他的更改包括处于不可中断状态的任务，因此平均负载反映了对磁盘资源的需求，而不仅仅是 cpu。</li></ol><h1 id="三、总结"><a href="#三、总结" class="headerlink" title="三、总结"></a>三、总结</h1><ol><li>linux load averages 数字大，代表系统压力大;<a id="more"></a></li><li>load 高可能的原因有(CPU、I/O、不可中断锁);</li><li>load 1min load 5min load 15min，从左到右递增说明负载在增加，递减说明负载在降低;</li><li>负载多大才算高，没有定论，得看是否影响业务，如果业务正常那多半是没有问题的;</li></ol><h1 id="四、load-优化"><a href="#四、load-优化" class="headerlink" title="四、load 优化"></a>四、load 优化</h1><ol><li>优化算法，减少 CPU 计算;</li><li>减少 I/O 交互的次数，以及大小;</li><li>分布式系统水平扩展更多的机器;</li></ol><h1 id="五、参考"><a href="#五、参考" class="headerlink" title="五、参考"></a>五、参考</h1><ol><li><a href="http://www.brendangregg.com/blog/2017-08-08/linux-load-averages.html" target="_blank" rel="noopener">Linux Load Averages: Solving the Mystery</a> (发表于 2017 年)</li><li><a href="http://www.ruanyifeng.com/blog/2011/07/linux_load_average_explained.html" target="_blank" rel="noopener">理解Linux系统负荷</a> （发表于 2011 年）</li><li><a href="https://blog.csdn.net/m0_37886429/article/details/78529681" target="_blank" rel="noopener">Linux中CPU使用率低负载高</a></li></ol></div><div></div><div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/linux/" rel="tag"># linux</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/20201019-java-hotspot-vm-cms-g1-setting-log/" rel="next" title="Java HotSpot 虚拟机 CMS、G1 参数优化对比记录"><i class="fa fa-chevron-left"></i> Java HotSpot 虚拟机 CMS、G1 参数优化对比记录</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/20201030-understanding-computer-storage-unit/" rel="prev" title="计算机存储单位 - 以及常识">计算机存储单位 - 以及常识 <i class="fa fa-chevron-right"></i></a></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview">站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="hisenyuan"><p class="site-author-name" itemprop="name">hisenyuan</p><p class="site-description motion-element" itemprop="description">Java R & D</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives"><span class="site-state-item-count">245</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories"><span class="site-state-item-count">26</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags"><span class="site-state-item-count">102</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/hisenyuan" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub </a></span><span class="links-of-author-item"><a href="http://weibo.com/hisenyuan" target="_blank" title="Weibo"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-globe"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://www.yuque.com/ruanyf/weekly" title="科技爱好者周刊" target="_blank">科技爱好者周刊</a></li><li class="links-of-blogroll-item"><a href="https://tech.meituan.com" title="美团技术团队" target="_blank">美团技术团队</a></li><li class="links-of-blogroll-item"><a href="http://duanple.com/?p=170" title="duanple(老师木)" target="_blank">duanple(老师木)</a></li><li class="links-of-blogroll-item"><a href="https://www.yinwang.org" title="当然我在扯淡(王垠)" target="_blank">当然我在扯淡(王垠)</a></li><li class="links-of-blogroll-item"><a href="http://nteswjq.blog.163.com" title="段永平的博客" target="_blank">段永平的博客</a></li><li class="links-of-blogroll-item"><a href="http://www.714.hk" title="梦殇国际" target="_blank">梦殇国际</a></li></ul></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#零、背景"><span class="nav-number">1.</span> <span class="nav-text">零、背景</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#一、解释"><span class="nav-number">2.</span> <span class="nav-text">一、解释</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二、load-averages-知识"><span class="nav-number">3.</span> <span class="nav-text">二、load averages 知识</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三、总结"><span class="nav-number">4.</span> <span class="nav-text">三、总结</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四、load-优化"><span class="nav-number">5.</span> <span class="nav-text">四、load 优化</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#五、参考"><span class="nav-number">6.</span> <span class="nav-text">五、参考</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2016 - <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">hisenyuan</span></div><div class="powered-by">由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div><span id="busuanzi_container_site_uv">您是第&nbsp;<span id="busuanzi_value_site_uv"></span>&nbsp;个访问者 </span>&nbsp;&nbsp; | &nbsp;&nbsp;<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="theme-info">主题 - <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.3/jquery.min.js"></script><script type="text/javascript" src="https://apps.bdimg.com/libs/fastclick/1.0.0/fastclick.min.js"></script><script type="text/javascript" src="https://apps.bdimg.com/libs/jquery-lazyload/1.9.5/jquery.lazyload.js"></script><script type="text/javascript" src="https://cdn.bootcss.com/velocity/1.2.1/velocity.min.js"></script><script type="text/javascript" src="https://cdn.bootcss.com/velocity/1.2.1/velocity.ui.js"></script><script type="text/javascript" src="https://apps.bdimg.com/libs/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script><script type="text/javascript">function proceedsearch(){$("body").append('<div class="popoverlay">').css("overflow","hidden"),$(".popup").toggle()}var isfetched=!1,search_path="search.xml";0==search_path.length&&(search_path="search.xml");var path="/"+search_path,searchFunc=function(e,t,a){"use strict";$.ajax({url:e,dataType:"xml",async:!0,success:function(e){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var r=$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get(),c=document.getElementById(t),n=document.getElementById(a);c.addEventListener("input",function(){var e=0,t='<ul class="search-result-list">',a=this.value.trim().toLowerCase().split(/[\s\-]+/);n.innerHTML="",this.value.trim().length>1&&r.forEach(function(r){var c=!1,n=r.title.trim().toLowerCase(),s=r.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),o=decodeURIComponent(r.url),i=-1,l=-1,p=-1;if(""!=n&&a.forEach(function(e,t){i=n.indexOf(e),l=s.indexOf(e),(i>=0||l>=0)&&(c=!0,0==t&&(p=l))}),c){e+=1,t+="<li><a href='"+o+"' class='search-result-title'>"+n+"</a>";var h=r.content.trim().replace(/<[^>]+>/g,"");if(p>=0){var u=p-20,d=p+80;u<0&&(u=0),0==u&&(d=50),d>h.length&&(d=h.length);var f=h.substring(u,d);a.forEach(function(e){var t=new RegExp(e,"gi");f=f.replace(t,'<b class="search-keyword">'+e+"</b>")}),t+='<p class="search-result">'+f+"...</p>"}t+="</li>"}}),t+="</ul>",0==e&&(t='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'),""==a&&(t='<div id="no-result"><i class="fa fa-search fa-5x" /></div>'),n.innerHTML=t}),proceedsearch()}})};$(".popup-trigger").click(function(e){e.stopPropagation(),0==isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(function(e){$(".popup").hide(),$(".popoverlay").remove(),$("body").css("overflow","")}),$(".popup").click(function(e){e.stopPropagation()})</script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("xHYsdhTdbcEW58Qv52aYKkQh-gzGzoHsz","L3rafXQHUnwDBfSL0KPuzHlT")</script><script>function showTime(e){var t=new AV.Query(e);$(".leancloud_visitors").each(function(){var e=$(this).attr("id").trim();t.equalTo("url",e),t.find({success:function(t){if(0==t.length){var n=$(document.getElementById(e)).text()+": 0";return void $(document.getElementById(e)).text(n)}var o=t[0],n=$(document.getElementById(e)).text()+": "+o.get("time");$(document.getElementById(e)).text(n)},error:function(e,t){console.log("Error: "+t.code+" "+t.message)}})})}function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim(),i=new AV.Query(e);i.equalTo("url",n),i.find({success:function(t){if(t.length>0){var i=t[0];i.fetchWhenSave(!0),i.increment("time"),i.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var r=new e,s=new AV.ACL;s.setPublicReadAccess(!0),s.setPublicWriteAccess(!0),r.setACL(s),r.set("title",o),r.set("url",n),r.set("time",1),r.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):$(".post-title-link").length>1&&showTime(e)})</script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script></body></html><!-- rebuild by neat -->